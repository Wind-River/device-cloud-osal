/* if there is no file system */
/**
 * @def PATH_MAX
 * @brief Maximum path length
 */
#ifndef PATH_MAX
#	define PATH_MAX 0
#endif

/**
 * @def DIRECTORY_CREATE_MAX_TIMEOUT
 * @brief Amount of time in milliseconds to wait for a directory to be
 *        created
 */
#define DIRECTORY_CREATE_MAX_TIMEOUT 300u

/* flags */
/** @brief Time stamps are relative to uptime */
#define OS_FLAG_RELATIVE_TIME  0x1

/** @brief maximum length for a field in system info structure */
#define OS_SYSTEM_INFO_MAX_LEN 64u

/** @brief Type for a socket */
typedef struct os_socket
{
	/** @brief Contains the address host address */
	struct sockaddr addr;
	/** @brief Contains the host port */
	os_uint16_t port;
	/** @brief File descriptor to the open socket */
	int fd;
	/** @brief Socket type */
	int type;
	/** @brief Socket protocol */
	int protocol;
} os_socket_t;

/** @brief operating system information structure */
typedef struct os_system_info
{
	/** @brief operating system vendor */
	char vendor_name[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief host name */
	char host_name[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief operating system name */
	char system_name[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief operating system platform */
	char system_platform[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief operating system release */
	char system_release[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief operating system version */
	char system_version[OS_SYSTEM_INFO_MAX_LEN + 1u];
	/** @brief operating system flag */
	os_uint8_t system_flags;
} os_system_info_t;

/* adapter information (for obtaining MAC addresses) */
/**
 * @brief Get general information of the current adapter in the the list
 *
 * @param[in,out]  adapters            adapter list to retrieve information from
 * @param[out]     family              family the adapter belongs to
 * @param[out]     flags               flags set on the adapter
 * @param[out]     address             buffer to fill with the address
 * @param[in]      address_len         size of the address buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_next
 * @see os_adapters_obtain
 * @see os_adapters_release
 */
OS_API OS_SECTION os_status_t os_adapters_address(
	os_adapters_t *adapters,
	int *family,
	int *flags,
	char *address,
	size_t address_len
);

/**
 * @brief Get the index of the current adapter in the the list
 *
 * @param[in,out]  adapters            adapter list to retrieve information from
 * @param[out]     index               index of the adapter
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_next
 * @see os_adapters_obtain
 * @see os_adapters_release
 */
OS_API OS_SECTION os_status_t os_adapters_index(
	os_adapters_t *adapters,
	unsigned int *index
);

/**
 * @brief Get the mac address of the current adapter in the list
 *
 * @param[in,out]  adapters            adapter list to retrieve information from
 * @param[out]     mac                 buffer to fill with the mac address
 * @param[in]      max_len             size of the buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_next
 * @see os_adapters_obtain
 * @see os_adapters_release
 */
OS_API OS_SECTION os_status_t os_adapters_mac(
	os_adapters_t *adapters,
	char *mac,
	size_t mac_len
);

/**
 * @brief Moves to the next adapter in the list
 *
 * @param[in,out]  adapters            adapter list to iterate
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_obtain
 * @see os_adapters_release
 */
OS_API OS_SECTION os_status_t os_adapters_next(
	os_adapters_t *adapters
);

/**
 * @brief Obtains the list of adapters connected to the system
 *
 * @param[out]     adapters            list of adapters
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_NO_MEMORY        out of memory
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_next
 * @see os_adapters_release
 */
OS_API OS_SECTION os_status_t os_adapters_obtain(
	os_adapters_t *adapters
);

/**
 * @brief Release memory allocated for the adapters
 *
 * @param[in,out]  adapters            adapter list to release
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_adapters_next
 * @see os_adapters_obtain
 */
OS_API OS_SECTION os_status_t os_adapters_release(
	os_adapters_t *adapters
);

/* character testing support */
/**
 * @brief Checks whether @p c is an alphabetical or numerical character
 *
 * @retval OS_FALSE                   character is not a alphabetical or
 *                                     numerical character
 * @retval OS_TRUE                    character is a alphabetical or  numerical
 *                                     character
 */
OS_API OS_SECTION os_bool_t os_char_isalnum(
	char c
);

/**
 * @brief Checks whether @p c is a hexadecimal digit
 *
 * @retval OS_FALSE                   character is not a hexadecimal digit
 * @retval OS_TRUE                    character is hexadecimal digit
 */
OS_API OS_SECTION os_bool_t os_char_isxdigit(
	char c
);


/** @brief flag indicating read operations */
#define OS_READ         0x01
/** @brief flag indicating write operations */
#define OS_WRITE        0x02
/** @brief flag indicating read & write operations */
#define OS_READ_WRITE   0x03
/** @brief flag indicating to append to end of the file */
#define OS_APPEND       0x04
/** @brief flag indicating to truncate the current contents */
#define OS_TRUNCATE     0x08
/** @brief flag indicating to create the file if it doesn't exist */
#define OS_CREATE       0x10
/** @brief flag indicating exclusive access to the file  */
#define OS_EXCLUSIVE    0x20
/** @brief flag indicating to that the file must not exist and to create it */
#define OS_CREATE_ONLY  0x30

/**
 * @brief Create a directory at the path specified with max_time_out in milliseconds
 *
 * @param[in]      path                path to directory to be created
 * @param[in]      timeout             maximum timeout for operation to complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_directory_create(
	const char *path,
	os_millisecond_t timeout
);
/**
 * @brief Create a directory at the path specified
 *
 * @param[in]      path                path to directory to be created
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_directory_create_nowait(
	const char *path
);

/**
 * @brief Stores the current directory into the buffer specified
 *
 * @param[out]     buffer              output destination
 * @param[in]      size                maximum size of destination buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          system error or the buffer is too small
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_directory_current(
	char *buffer,
	size_t size
);
/**
 * @brief Change the specified directory as current working directory
 *
 * @param[in]      path                path to directory to be changed
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          failed to change current directory
 * @retval OS_STATUS_SUCCESS          directory was successfully changed
 */
OS_API OS_SECTION os_status_t os_directory_change(const char *path);
/**
 * @brief Opens the specified directory for exploration
 *
 * @param[in]      dir_path            path to directory to open
 * @param[out]     out                 pointer to directory stream
 *
 * @retval OS_STATUS_FAILURE          failed to open directory
 * @retval OS_STATUS_SUCCESS          directory was successfully opened
 */
OS_API OS_SECTION os_status_t os_directory_open(
	const char *dir_path,
	os_dir_t* out
);
/**
 * @brief Closes a previously opened directory stream
 *
 * @param[in]      dir                 directory to close
 *
 * @retval OS_STATUS_FAILURE          failed to close directory
 * @retval OS_STATUS_SUCCESS          successfully closed directory
 */
OS_API OS_SECTION os_status_t os_directory_close(
	os_dir_t *dir
);
/**
 * @brief Deletes all files (and empty directories) matching a regular
 *        expression from the given directory
 *
 * @note This only works in the directory specified, i.e. it doesn't recurse down
 * @note This function doesn't remove the base directory
 *
 * @param[in]      path                path to directory to delete
 * @param[in]      regex               regular expression for a sub-directory of
 *                                     file to match (a value of NULL will also
 *                                     delete this directory; a value of "*"
 *                                     deletes all files in the directory
 *                                     but leaves directory)
 * @param[in]      recursive           go recursively through subdirectories
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_BAD_REQUEST      regular expression contains invalid
 *                                     character(s)
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NO_MEMORY        out of memory
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TRY_AGAIN        directory is not empty
 *
 * @see os_directory_delete
 * @see os_directory_exists
 * @see os_file_delete
 */
OS_API OS_SECTION os_status_t os_directory_delete(
	const char *path,
	const char *regex,
	os_bool_t recursive
);
/**
 * @brief Returns whether or not a directory exists
 *
 * @param[in]      dir_path            path to directory to check existence
 *
 * @retval OS_TRUE                    directory exists
 * @retval OS_FALSE                   directory does not exist
 */
OS_API OS_SECTION os_bool_t os_directory_exists(
	const char *dir_path
);
/**
 * @brief Get amount of free space on partition containing path
 *
 * @param[in]       path               path of file indicating which partition
 *                                     to query
 *
 * @retval          >=0                free space on partition in bytes
 * @retval          -1                 on failure
 */
OS_API OS_SECTION os_uint64_t os_directory_free_space(
	const char* path
);

/**
 * @brief Get temp directory path
 *
 * @param[in]       dest               destination buffer
 * @param[in]       size               buffer size
 *
 * @return the os temp directory path
 *
 */
OS_API OS_SECTION const char *os_directory_get_temp_dir(
	char * dest, size_t size
);

/**
 * @brief Get next file in opened directory
 *
 * @param[in]      dir                 directory to look in
 * @param[in]      files_only          only return the next file, ignoring all
 *                                     sub-directories
 * @param[out]     path                buffer to write the path of next file to
 * @param[in]      path_len            size of buffer
 *
 * @retval OS_STATUS_FAILURE          failed to retrieve next file, might have
 *                                     reached the end of the directory
 * @retval OS_STATUS_SUCCESS          successfully retrieved the next file
 */
OS_API OS_SECTION os_status_t os_directory_next(
	os_dir_t *dir,
	os_bool_t files_only,
	char *path,
	size_t path_len
);
/**
 * @brief Reset a directory stream to the beginning of its contents
 *
 * @param[in,out]  dir                 directory to reset
 *
 * @retval OS_STATUS_FAILURE          failed to rewind directory
 * @retval OS_STATUS_SUCCESS          successfully rewound directory
 *
 *
 */
OS_API OS_SECTION os_status_t os_directory_rewind(
	os_dir_t *dir
);

/**
 * @brief changes the owner and group of a file
 *
 * @param[in]      path                path to the specified file
 * @param[in]      user                new owner for the file
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          Failed to change ownership of the file
 * @retval OS_STATUS_SUCCESS          Successfully changed ownership of the
 *                                     file
 */
OS_API OS_SECTION os_status_t os_file_chown(
	const char *path,
	const char *user
);

/**
 * @brief Close file stream
 *
 * @param[in,out]  handle              Pointer to file stream to close
 *
 * @retval         OS_STATUS_SUCCESS  Successfully closed file stream
 * @retval         OS_STATUS_FAILURE  Failed to close file stream
 *
 * @see os_file_open
 */
OS_API OS_SECTION os_status_t os_file_close(
	os_file_t handle
);

/**
 * @brief Copies a file in the file system
 *
 * @param[in]      old_path            path of the file to copy
 * @param[in]      new_path            location to copy file to
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_file_move
 */
OS_API OS_SECTION os_status_t os_file_copy(
	const char *old_path,
	const char *new_path
);

/**
 * @brief Deletes a file from the system
 *
 * @param[in]      path                path to file to delete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_directory_delete
 * @see os_file_exists
 */
OS_API OS_SECTION os_status_t os_file_delete(
	const char *path
);
/**
 * @brief Determines whether a specified file exists
 *
 * @param[in]      file_path           Path to specified file
 *
 * @retval         OS_TRUE            File exists
 * @retval         OS_FALSE           File does not exist
 *
 * @see os_file_remove
 */
OS_API OS_SECTION os_bool_t os_file_exists(
	const char *file_path
);

/**
 * @brief Move the current position in an file stream
 *
 * @param[in,out]  stream              stream to pointer of
 * @param[in]      offset              amount to remove file pointer
 * @param[in]      whence              where to apply the offset at
 *
 * @retval OS_STATUS_BAD_PARAMETER    bad parameter passed to the function
 * @retval OS_STATUS_FAILURE          failed to move file pointer
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_file_fseek(
	os_file_t stream,
	long offset,
	int whence
);

/**
 * @brief Fsync file
 *
 * @param[in]      file_path           path to file to fsync
 *                                     do sync if file_path is NULL (linux)
 *
 * @retval OS_STATUS_BAD_PARAMETER    bad parameter passed to the function
 * @retval OS_STATUS_SUCCESS          Successfully sync the file
 * @retval OS_STATUS_FAILURE          Failed to sync file stream
 *
 */
OS_API OS_SECTION os_status_t os_file_fsync(
	const char *file_path
);

/**
 * @brief Get size of file in bytes
 *
 * @param[in]      file_path           path to file
 *
 * @return         File size in bytes
 */
OS_API OS_SECTION os_uint64_t os_file_get_size(
	const char *file_path
);

/**
 * @brief Get size of file in bytes
 *
 * @param[in]      file_handle         file handle
 *
 * @return         File size in bytes
 */
OS_API OS_SECTION os_uint64_t os_file_get_size_handle(
	os_file_t file_handle
);

/**
 * @brief Moves a file in the file system
 *
 * @param[in]      old_path            path of the file to move
 * @param[in]      new_path            location to move file to
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_file_copy
 */
OS_API OS_SECTION os_status_t os_file_move(
	const char *old_path,
	const char *new_path
);

/**
 * @brief Open a file stream for reading or writing
 *
 * @param[in]      file_path           path to file to open
 * @param[in]      flags               access mode flags for file stream
 *
 * @note flags are set as a bitwise OR operation of the following:
 *       \n OS_READ
 *       \n OS_WRITE
 *       \n OS_APPEND
 *       \n OS_EXCLUSIVE
 *       \n OS_CREATE_ONLY
 *       \n OS_TRUNCATE
 *
 * @retval         !NULL               on success
 * @retval         NULL                on failure
 *
 * @see os_file_close
 */
OS_API OS_SECTION os_file_t os_file_open(
	const char *file_path,
	int flags
);

/**
 * @brief Generates a temporary file based on the specified prototype
 *
 * @param[in,out]  prototype           prototype to use / temporary file name
 * @param[in]      suffix_len          suffix length
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_file_temp(
	char *prototype,
	size_t suffix_len
);

/**
 * @brief Waits for the user to press a key on a console window
 *
 * @return the character that was received
 */
OS_API OS_SECTION char os_key_wait( void );

#ifndef _WRS_KERNEL
/**
 * @brief Closes an open runtime library
 *
 * @param[in]      lib                 open library handle to close
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_library_find
 * @see os_library_open
 */
OS_API OS_SECTION os_status_t os_library_close(
	os_lib_handle lib
);
#endif /* ifndef _WRS_KERNEL */

/**
 * @brief Builds the path to a file for the operating system
 *
 * @param[in]      path                destination to store result
 * @param[in]      len                 size of destination buffer
 * @param[in]      ...                 directories and file name passed in as
 *                                     strings, until NULL is passed.
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FULL             the buffer specified is too small to hold
 *                                     the path
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_make_path(
	char *path,
	size_t len,
	...
);

/* string functions */
/**
 * @brief Convert a string to an integer
 *
 * @param[in]      str                 string to convert
 *
 * @return an integer value of the string converted (0 is the default)
 */
OS_API OS_SECTION int os_atoi( const char *str );

/**
 * @brief Compares two strings ignoring case
 *
 * @param[in]      s1                  first string to compare
 * @param[in]      s2                  second string to compare
 *
 * @retval         <0                  the first non-matching character has a
 *                                     lower value in s1 than in s2
 * @retval         0                   the two strings are equal
 * @retval         >0                  the first non-matching character has a
 *                                     higher value in s1 than in s2
 */
OS_API OS_SECTION int os_strcasecmp(
	const char *s1,
	const char *s2
);

/**
 * @brief Finds the length of the initial portion of str1 before the first occurrence
 *        of any characters that are part of str2
 *
 * @param[in]      str1                String to search
 * @param[in]      str2                String containing characters to match
 *
 * @return The length of the initial portion of str1 containing only characters
 *         that do not appear in str2
 */
size_t os_strcspn(
	const char *str1,
	const char *str2
);

/**
 * @brief Compares two strings up to a certain number of characters ignoring case
 *
 * @param[in]      s1                  first string to compare
 * @param[in]      s2                  second string to compare
 * @param[in]      len                 maximum number of characters to compare
 *
 * @retval         <0                  the first non-matching character has a
 *                                     lower value in s1 than in s2
 * @retval         0                   the two strings are equal up to len
 *                                     characters
 * @retval         >0                  the first non-matching character has a
 *                                     higher value in s1 than in s2
 */
OS_API OS_SECTION int os_strncasecmp(
	const char *s1,
	const char *s2,
	size_t len
);

/**
 * @brief Concatenates two strings
 *
 * @param[in]      s1                  destination string
 * @param[in]      s2                  string to add to s1
 * @param[in]      count               number of characters to concatenate from s2 to s1
 *
 * @retval         !NULL               pointer to the successfully concatenated string
 * @retval         NULL                indicates an error occurred
 */
OS_API OS_SECTION char *os_strncat(
	char *s1,
	const char *s2,
	size_t count
	);

/**
 * @brief Finds the first occurrence of some specified characters in a string
 *
 * @param[in]      str1                String to search
 * @param[in]      str2                Characters to search for
 *
 * @retval         !NULL               Pointer to the first occurrence of
 *                                     one of the characters in str2 in str1
 * @retval         NULL                None of the characters in str2 appear
 */
OS_API OS_SECTION char *os_strpbrk(
	const char *str1,
	const char *str2
);

/**
 * @brief Finds the length of the initial portion of str1 which consists only
 *        of characters that are part of str2
 *
 * @param[in]      str1                String to search
 * @param[in]      str2                String containing characters to match
 *
 * @return The length of the initial portion of str1 containing only characters
 *         that appear in str2
 */
OS_API OS_SECTION size_t os_strspn(
	const char *str1,
	const char *str2
);

/**
 * @brief Get the next token from a string
 *
 * @param[in,out]  str                 string to truncate, if it is set to NULL,
 *                                     it will use the last str value
 * @param[in]      delimiters          string containing delimiter characters
 *
 * @retval         !NULL               token is found
 * @retval         NULL                no token found
 */
OS_API OS_SECTION char *os_strtok(
	char *str,
	const char *delimiters
);

/* memory functions */
/**
 * @brief Compares two blocks of memory
 *
 * @param[in]      ptr1                pointer to first block of memory
 * @param[in]      ptr2                pointer to second block of memory
 * @param[in]      num                 amount of bytes to compare
 *
 * @retval         <0                  first non-matching byte is lower in ptr1
 * @retval         0                   all bytes are equal
 * @retval         >0                  first non-matching byte is lower in ptr2
 */
OS_API OS_SECTION int os_memcmp(
	const void *ptr1,
	const void *ptr2,
	size_t num
);

/* print functions */
/**
 * @brief Extracts any environment variables in the source string
 *
 * @note Enviroment variables in the source string are in the format as defined
 *       by the operating system (i.e. for Windows: %VAR%; for POSIX: $VAR )
 *
 * @param[in]      src                 source string (containing environment
 *                                     variable as defined by the operating
 *                                     system)
 * @param[in]      len                 buffer size
 *
 * @return the size of the output string (0 if either src is NULL) or
 * required size if too small
 *
 * @see os_env_get
 */
OS_API OS_SECTION size_t os_env_expand(
	char *src,
	size_t len
);

/**
 * @brief Obtains the value for a single environment variable
 *
 * @note The string is guaranteed to be null-terminated (if @c dest is supplied
 *       and @c len > 0u);  If the buffer is not large enough then result
 *       will equal len
 *
 * @param[in]      env                 environment variable
 * @param[in,out]  dest                destination string
 * @param[in]      len                 destination size
 *
 * @retval 0       if either @c env or @c dest is @c NULL
 * @retval >0      the size of the output string
 *
 * @see os_env_expand
 */
OS_API OS_SECTION size_t os_env_get(
	const char *env,
	char *dest,
	size_t len
);

/**
 * @brief Writes output to a string
 *
 * @warning this function may write pass the end of the string, for safety
 *          use os_snprintf instead
 *
 * @param[out]     str                 string to output to
 * @param[in]      format              string format
 * @param[in]      ...                 items to replace based on @p format
 *
 * @return the number of characters printed including the null-terminator
 *
 * @see os_snprintf
 */
OS_API OS_SECTION int os_sprintf(
	char *str,
	const char *format,
	...
) __attribute__((format(printf,2,3)));

/**
 * @brief Flushes a stream to ensure a buffer is transmitted
 *
 * @param[in]      stream              stream to flush
 *
 * @retval OS_FALSE                   on failure
 * @retval OS_TRUE                    on success
 */
OS_API OS_SECTION os_bool_t os_flush(
	os_file_t stream
);

/**
 * @brief Determines if a given path is an absolute path
 *
 * @note This function does NOT check if the path contains invalid characters
 *
 * @param[in]      path                path to test
 *
 * @retval OS_TRUE     path is an absolute path
 * @retval OS_FALSE    path is not an absolute path (or PATH is NULL)
 */
OS_API OS_SECTION os_bool_t os_path_is_absolute(
	const char *path
);

/**
 * @brief Get the full path to executable
 *
 * @param[out]     path                buffer to put full path to executable
 * @param[in]      size                size of the buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_path_executable(
	char *path,
	size_t size
);

/* process functions */
/**
 * @brief Release resources when a child process exists
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_process_cleanup( void );

/* service functions */
/**
 * @brief Function to call if running as a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      service_function    function pointer for service controller to run
 * @param[in]      argc                parameter count for service_function
 * @param[in,out]  argv                array of parameters for service_function
 * @param[in]      remove_argc         size of remove argument array
 * @param[in]      remove_argv         array of arguments to remove before
 *                                     passing to the @c service_function
 * @param[in]      handler             service signal handler
 * @param[in]      logdir              directory where log files will be placed
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad parameters
 * @retval OS_STATUS_FAILURE          on failure to start service
 */
OS_API OS_SECTION os_status_t os_service_run(
	const char *id,
	os_service_main_t service_function,
	int argc,
	char *argv[],
	int remove_argc,
	const char *remove_argv[],
	os_sighandler_t handler,
	const char *logdir
);

/**
 * @brief Install an executable as a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      executable          full path to the executable
 * @param[in]      args                arguments to pass to the executable
 * @param[in]      name                name (or short description) of the service
 * @param[in]      description         (optional) brief description of the service
 * @param[in]      dependencies        (optional) list of dependencies,
 *                                     seperated by semi-colons
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad mandatory parameter(s)
 * @retval OS_STATUS_EXISTS           service already exists
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id
 */
OS_API OS_SECTION os_status_t os_service_install(
	const char *id,
	const char *executable,
	const char *args,
	const char *name,
	const char *description,
	const char *dependencies,
	os_millisecond_t max_time_out
);

/**
 * @brief Uninstall a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad mandatory parameter(s)
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id
 */
OS_API OS_SECTION os_status_t os_service_uninstall(
	const char *id,
	os_millisecond_t max_time_out
);

/**
 * @brief Start a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad mandatory parameter(s)
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id.
 */
OS_API OS_SECTION os_status_t os_service_start(
	const char *id,
	os_millisecond_t max_time_out
);

/**
 * @brief Stop a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      exe                 filename used by the service
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad mandatory parameter(s)
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id.
 */
OS_API OS_SECTION os_status_t os_service_stop(
	const char *id,
	const char *exe,
	os_millisecond_t max_time_out
);

/**
 * @brief Restart a service
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      exe                 filename used by the service
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_BAD_PARAMETER    on bad mandatory parameter(s)
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id.
 */
OS_API OS_SECTION os_status_t os_service_restart(
	const char *id,
	const char *exe,
	os_millisecond_t max_time_out
);

/**
 * @brief Queries a service for its current status
 *
 * @param[in]      id                  id identifying the service
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter(s) passed to function
 * @retval OS_STATUS_FAILURE          failed to query service or in a failed state
 * @retval OS_STATUS_NOT_FOUND        service is not found
 * @retval OS_STATUS_NOT_INITIALIZED  service is not active (or connecting)
 * @retval OS_STATUS_NOT_SUPPORTED    if not supported on current OS
 * @retval OS_STATUS_SUCCESS          service is active & running
 * @retval OS_STATUS_TIMED_OUT        the query timed out before completion
 *
 * @note Forward-slashes (/) and Backslashes (\) are not valid within a
 *       service id.
 */
OS_API OS_SECTION os_status_t os_service_query(
	const char *id,
	os_millisecond_t max_time_out
);

/* socket functions */
/**
 * @brief Get the IP address that a host resolves to
 *
 * @param[in]      host                hostname to resolve
 * @param[in]      service             service or port to use for resolution
 * @param[out]     address             the resulting IP address that the host resolves to
 * @param[in]      address_len         length of the IP address char array
 * @param[in] family         address family to use for resolution
 *
 * @retval 0       on success
 * @retval !0      on failure (see getaddrinfo() return codes)
 */
 OS_API OS_SECTION int os_get_host_address(
	const char *host,
	const char *service,
	char *address,
	int address_len,
	int family
);

/**
 * @brief Accepts an incoming connection
 *
 * @param[in]      socket              socket to accept connection on
 * @param[out]     out                 accepted socket connection
 * @param[in]      max_time_out        maximum time to wait for operation to
 *                                     complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter(s) passed to function
 * @retval OS_STATUS_FAILURE          failed to accept connection
 * @retval OS_STATUS_SUCCESS          successfully bound to socket
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 *
 * @see os_socket_bind
 */
OS_API OS_SECTION os_status_t os_socket_accept(
	const os_socket_t *socket,
	os_socket_t *out,
	os_millisecond_t max_time_out
);

/**
 * @brief Binds to a socket to listen and accept connections on
 *
 * @param[in]      socket              socket to bind to
 * @param[in]      queue_size          size of queue to hold incoming
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter(s) passed to function
 * @retval OS_STATUS_FAILURE          failed to bind to socket
 * @retval OS_STATUS_SUCCESS          successfully bound to socket
 *
 * @see os_socket_accept
 * @see os_socket_open
 * @see os_socket_close
 */
OS_API OS_SECTION os_status_t os_socket_bind(
	const os_socket_t *socket,
	int queue_size
);

/**
 * @brief Sends a broadcast packet on the socket specified
 *
 * @param[in,out]  socket              socket to broadcast on
 * @param[in]      buf                 raw data to broadcast
 * @param[in]      len                 size of raw data to broadcast
 * @param[in]      ttl                 time-to-live for broadcast packet
 * @param[out]     bytes_written       number of bytes successfully written
 * @param[in]      max_time_out        maximum time to wait for operation to
 *                                     complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter(s) passed to function
 * @retval OS_STATUS_FAILURE          failed to accept connection
 * @retval OS_STATUS_SUCCESS          successfully bound to socket
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 */
OS_API OS_SECTION os_status_t os_socket_broadcast(
	const os_socket_t *socket,
	const void *buf,
	size_t len,
	int ttl,
	size_t *bytes_written,
	os_millisecond_t max_time_out
);

/**
 * @brief Closes an open socket
 *
 * @param[in,out]  socket              socket to close
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_socket_open
 */
OS_API OS_SECTION os_status_t os_socket_close(
	os_socket_t *socket
);
/**
 * @brief Connects to a socket to send and receive data
 *
 * @param[in]      socket              socket to connect to
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to the function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_socket_connect(
	const os_socket_t *socket
);
/**
 * @brief Initializes resources for raw socket communicationa within a process
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_socket_terminate
 */
OS_API OS_SECTION os_status_t os_socket_initialize( void );
/**
 * @brief Opens an open socket
 *
 * @param[out]     out                 a pointer to the open socket
 * @param[in]      address             IPv4 or IPv6 host address to open
 * @param[in]      port                port to open socket on
 * @param[in]      type                socket type (SOCKET_STREAM or SOCKET_DGRAM)
 * @param[in]      protocol            protocol index to use in family
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 *
 * @see os_socket_close
 */
OS_API OS_SECTION os_status_t os_socket_open(
	os_socket_t *out,
	const char *address,
	os_uint16_t port,
	int type,
	int protocol,
	os_millisecond_t max_time_out
);
OS_API OS_SECTION os_status_t os_socket_option(
	const os_socket_t *socket,
	int level,
	int optname,
	const void *optval,
	size_t optlen
);
/**
 * @brief reads data for an open socket
 *
 * @param[in]      socket              socket to read from
 * @param[out]     buf                 destination buffer
 * @param[in]      len                 size of buffer
 * @param[out]     bytes_read          amount of data read in bytes
 * @param[in]      max_time_out        maximum time out for operation to complete
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 * @retval OS_STATUS_TRY_AGAIN        socket not connected
 *
 * @see os_socket_write
 */
OS_API OS_SECTION os_status_t os_socket_read(
	const os_socket_t *socket,
	void *buf,
	size_t len,
	size_t* bytes_read,
	os_millisecond_t max_time_out
);
OS_API OS_SECTION ssize_t os_socket_receive(
	const os_socket_t *socket,
	void *buf,
	size_t len,
	char *src_addr,
	size_t src_addr_len,
	os_uint16_t *port,
	os_millisecond_t max_time_out
);
OS_API OS_SECTION ssize_t os_socket_send(
	const os_socket_t *socket,
	const void *buf,
	size_t len,
	const char *dest_addr,
	os_uint16_t port,
	os_millisecond_t max_time_out
);
/**
 * @brief Cleans up resources utilized for raw socket communication
 *        within a process
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 *
 * @see os_socket_initialize
 */
OS_API OS_SECTION os_status_t os_socket_terminate( void );
/**
 * @brief Writes data to an open socket
 *
 * @param[in]      socket              socket to write to
 * @param[in]      buf                 destination buffer
 * @param[in]      len                 size of buffer
 * @param[out]     bytes_written       number of bytes written in bytes
 * @param[in]      max_time_out        maximum amount of time to wait
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 *
 * @see os_socket_read
 */
OS_API OS_SECTION os_status_t os_socket_write(
	const os_socket_t *socket,
	const void *buf,
	size_t len,
	size_t *bytes_written,
	os_millisecond_t max_time_out
);

/**
 * @brief Enable or disable echo in a stream
 *
 * @param[in]      stream              handle to stream to set
 * @param[in]      enable              true to enable, false to disable
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_stream_echo_set(
	os_file_t stream,
	os_bool_t enable );

/* operating system information */

/**
 * @brief Returns the error message for indicated operating system error number
 *
 * @warning The function is not thread-safe.
 *
 * @param[in]      error_number        error number to lookup (-1 for last error)
 *
 * @return a string representing the last operating system error
 */
OS_API OS_SECTION const char *os_system_error_string(
	int error_number
);

/**
 * @brief Extracts information about the the operating system
 *
 * @param[in,out]  sys_info            structure to fill with operating system
 *                                     information
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_system_info(
	os_system_info_t *sys_info
);

/**
 * @brief run an executable on the operating system asynchronously
 *
 * @param[in]      command             command string to be run
 * @param[out]     exit_status         return code of the executable (optional)
 * @param[in]      pipe_files          files/pipes to write 'standard out' & 
 *									   'standard error' to
 *
 * @retval OS_STATUS_INVOKED          command triggered as a background process
 * @retval OS_STATUS_NOT_EXECUTABLE   the path provided can not be executed
 */
OS_API OS_SECTION os_status_t os_system_run(
	const char *command,
	int *exit_status,
	os_file_t pipe_files[2u] );

/**
 * @brief run an executable on the operating system and wait for it to complete
 *
 * @param[in]      command             command string to be run
 * @param[out]     exit_status         return code of the executable (optional)
 * @param[out]     out_buf             pointer to buffers to write
 *                                     'standard out' & 'standard error' to
 * @param[in,out]  out_len             size of buffers for 'standard out' and
 *                                     'standard error'
 * @param[in]      max_time_out        maximum amount of time to wait
 *
 * @retval OS_STATUS_IO_ERROR         failed to setup error & output capture io
 * @retval OS_STATUS_NOT_EXECUTABLE   the path provided can not be executed
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 */
OS_API OS_SECTION os_status_t os_system_run_wait(
	const char *command,
	int *exit_status,
	char *out_buf[2u],
	size_t out_len[2u],
	os_millisecond_t max_time_out );

/**
 * @brief Shutdown or reboot the device
 *
 * @param[in]      reboot              specify whether to reboot or shutdown the
 *                                     device
 * @param[in]      delay               time delay in minutes to reboot or shutdown
 *
 * @retval OS_STATUS_INVOKED          shutdown triggered
 * @retval OS_STATUS_NOT_EXECUTABLE   shutdown failed to be triggered
 */
OS_API OS_SECTION os_status_t os_system_shutdown(
	os_bool_t reboot, unsigned int delay
);

/**
 * @brief tests the provided steram to determine if it supports vt-100
 *        terminal codes
 *
 * @param[in]      stream              stream to test
 *
 * @retval OS_TRUE                    terminal supports vt-100 codes
 * @retval OS_FALSE                   terminal does not support vt-100 codes
 */
OS_API OS_SECTION os_bool_t os_terminal_vt100_support(
	os_file_t stream
);

/**
 * @brief Function to setup a signal handler
 *
 * @param[in]      signal_handler      callback function to be called when a
 *                                     signal is encountered, NULL to remove a
 *                                     previously registered signal handler
 *
 * @retval OS_STATUS_FAILURE          on failure
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_terminate_handler(
	os_sighandler_t signal_handler
);

/* time functions */
/**
 * @brief Generate a random number between a minimum and maximum
 *
 * @param[in]     min                  minimum value
 * @param[in]     max                  maximum value
 *
 * @return a random number between the minimum and maximum specified
 */
OS_API OS_SECTION double os_random(
	double min,
	double max
);

/**
 * @brief Returns the system time
 *
 * @note This function will return either an absolute time or up time depending
 *       on the system implementation and support level
 *
 * @param[out]     time_stamp          current time
 * @param[out]     up_time             set to OS_TRUE, if the system only
 *                                     supports the up time; this is alway set
 *                                     correctly independent of this function's
 *                                     return code (optional)
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_FAILURE          system call failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_time(
	os_timestamp_t *time_stamp,
	os_bool_t *up_time
);

/**
 * @brief Returns the system time in a formatted string
 *
 * @param[out]     buf                 pointer to buffer to place the time string
 * @param[in]      len                 length of the buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_FAILURE          system call failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_time_format(
	char *buf,
	size_t len );

/**
 * @brief Calculates the amount of time elapsed from a given time
 *
 * @param[in]      start_time          starting time
 * @param[out]     elapsed_time        elapsed time in milliseconds
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_BAD_REQUEST      starting time is in the future
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_time_elapsed(
	os_timestamp_t *start_time,
	os_millisecond_t *elapsed_time );

/**
 * @brief Calculates the amount of time remaining from a start time and time out
 *
 * @param[in]      start_time          starting time
 * @param[in]      max_time_out        max amount of time (0 means forever)
 * @param[out]     remaining           amount of time remaining
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter
 * @retval OS_STATUS_BAD_REQUEST      starting time is in the future
 * @retval OS_STATUS_TIMED_OUT        time out exceeded
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_time_remaining(
	os_timestamp_t *start_time,
	os_millisecond_t max_time_out,
	os_millisecond_t *remaining );

/**
 * @brief Sleeps for the specified time in milliseconds
 *
 * @param[in]      ms                  number of milliseconds to sleep for
 * @param[in]      allow_interrupts    allow the sleep to break on an interrupt
 *
 * @retval OS_STATUS_FAILURE          on system failure or system interruption
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_time_sleep(
	os_millisecond_t ms,
	os_bool_t allow_interrupts
);

/* threading */
#ifndef NO_THREAD_SUPPORT
/**
 * @brief Symbol to correct declare a thread on all platforms
 */
#define OS_THREAD_DECL OS_THREAD_RETURN OS_THREAD_LINK
/**
 * @brief Type defining the starting point for a thread
 */
typedef OS_THREAD_RETURN
	(OS_THREAD_LINK *os_thread_main_t)( void *arg );

/**
 * @brief Wakes up all threads waiting on a condition variable
 *
 * @param[in,out]  cond                condition variable to wake up
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_condition_broadcast(
	os_thread_condition_t *cond
);

/**
 * @brief Creates a new condition variable
 *
 * @param[in,out]  cond                newly created condition variable
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_condition_create(
	os_thread_condition_t *cond
);

/**
 * @brief Destroys a previously created condition variable
 *
 * @param[in,out]  cond                previously created condition variable
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_condition_destroy(
	os_thread_condition_t *cond
);

/**
 * @brief Signals a thread waiting on a condition variable to wake up
 *
 * @param[in,out]  cond                condition variable to signal
 * @param[in,out]  lock                lock prototecting condition variable
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_condition_signal(
	os_thread_condition_t *cond,
	os_thread_mutex_t *lock
);

/**
 * @brief Waits a specified amount of time for a condition variable
 *
 * @param[in,out]  cond                condition variable to wait on
 * @param[in,out]  lock                lock protecting condition variable
 * @param[in]      max_time_out        maximum amount of time to wait
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 * @retval OS_STATUS_TIMED_OUT        maximum wait time reached
 */
OS_API OS_SECTION os_status_t os_thread_condition_timed_wait(
	os_thread_condition_t *cond,
	os_thread_mutex_t *lock,
	os_millisecond_t max_time_out
);

/**
 * @brief Creates a new thread
 *
 * @param[in,out]  thread              newly created thread object
 * @param[in]      main                main method to call for the thread
 * @param[in]      arg                 user specific data
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_create(
	os_thread_t *thread,
	os_thread_main_t main,
	void *arg
);

/**
 * @brief Destroys a previously created thread
 *
 * @param[in,out]  thread              thread object to destroy
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_destroy(
	os_thread_t *thread
);

/**
 * @brief Creates a new mutally exclusive lock
 *
 * @param[in,out]  lock                newly created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_mutex_create(
	os_thread_mutex_t *lock
);

/**
 * @brief Destroys a mutally exclusive lock
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_mutex_destroy(
	os_thread_mutex_t *lock
);

/**
 * @brief Obtains a mutally exclusive lock (waits until lock is available)
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_mutex_lock(
	os_thread_mutex_t *lock
);

/**
 * @brief Releases a mutally exclusive lock
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_mutex_unlock(
	os_thread_mutex_t *lock
);

/**
 * @brief Creates a new read/write lock
 *
 * @param[in,out]  lock                newly created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_create(
	os_thread_rwlock_t *lock
);

/**
 * @brief Destroys a previously created read/write lock
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_destroy(
	os_thread_rwlock_t *lock
);

/**
 * @brief Obtains a read/write lock for reading
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_read_lock(
	os_thread_rwlock_t *lock
);

/**
 * @brief Releases read/write lock from reading
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_read_unlock(
	os_thread_rwlock_t *lock
);

/**
 * @brief Obtains a read/write lock for writing
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_write_lock(
	os_thread_rwlock_t *lock
);

/**
 * @brief Releases read/write lock from writing
 *
 * @param[in,out]  lock                previously created lock
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_rwlock_write_unlock(
	os_thread_rwlock_t *lock
);

/**
 * @brief Waits for a thread to complete
 *
 * @param[in,out]  thread              thread object to wait on
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_thread_wait(
	os_thread_t *thread
);
#endif /* ifndef NO_THREAD_SUPPORT */

/* uuid support */
/**
 * @brief Generates a universally unique identifier
 *
 * @param[out]     uuid                generated identifier
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_FAILURE          function failed
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_uuid_generate(
	os_uuid_t *uuid
);

/**
 * @brief Converts universally unique identifier to lower-case
 *
 * @param[in]      uuid                universally unique identifier
 * @param[out]     dest                destination buffer
 * @param[in]      len                 size of destination buffer
 *
 * @retval OS_STATUS_BAD_PARAMETER    invalid parameter passed to function
 * @retval OS_STATUS_NO_MEMORY        buffer length is not large enough
 * @retval OS_STATUS_SUCCESS          on success
 */
OS_API OS_SECTION os_status_t os_uuid_to_string_lower(
	os_uuid_t *uuid,
	char *dest,
	size_t len
);

#ifdef __cplusplus
}
#endif /* ifdef __cplusplus */

#endif /* ifndef OS_H */

